machine:
  services:
    - docker
  node:
    version: 6.1.0

dependencies:
  pre:
    - scripts/ci/common/set-build-target.sh
    - scripts/ci/backend/dependencies--pre.sh
  override:
    - scripts/ci/backend/dependencies--override.sh
    - scripts/ci/frontend/dependencies--override.sh
  cache_directories:
    - backend/.gradle
    - tools
    - frontend-web/node_modules

test:
  override:
    - scripts/ci/backend/test--override.sh
    - scripts/ci/frontend/test--override.sh
  post:
    - scripts/ci/backend/test--post.sh

deployment:
  develop:
    branch: develop
    commands:
      - scripts/ci/backend/deployment--develop--commands.sh
  master:
    branch: master
    commands:
      - scripts/ci/backend/deployment--master--commands.sh
