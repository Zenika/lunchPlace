machine:
  services:
    - docker
  java:
    version: openjdk8

dependencies:
  override:
    - echo "overriding dependencies with nothing"

test:
  pre:
    - docker version
    - docker pull metahelicase/gradle:3.1
  override:
    - docker run --rm -v `pwd`/backend:/project -u `id -u`:`id -g` metahelicase/gradle:3.1 --console plain build writeProjectVersion
  post:
    - export PROJECT_VERSION=$(cat backend/build/version.txt)
    - echo "found $PROJECT_VERSION"

deployment:
  hub:
    branch: develop
    commands:
      - docker build -t zenika/lunchplace_backend
